window.addEventListener("load",(async()=>{try{document.getElementById("loading").style.display="block",window.ethereum?(window.web3=new Web3(window.ethereum),await window.ethereum.request({method:"eth_requestAccounts"})):window.web3=new Web3(new Web3.providers.HttpProvider("http://localhost:7545"));const e=await web3.eth.net.getId(),t=ToDoList.networks[e],n=new web3.eth.Contract(ToDoList.abi,t.address),o=await n.methods.taskCount().call(),d=document.getElementById("taskList");for(let e=1;e<=o;e++){const t=await n.methods.tasks(e).call(),o=document.createElement("div");o.innerHTML=t.content+(t.completed?" (Completed)":""),d.appendChild(o)}document.getElementById("createTaskButton").addEventListener("click",(async()=>{const e=document.getElementById("newTask").value,t=await web3.eth.getAccounts();await n.methods.createTask(e).send({from:t[0]}),window.location.reload()})),document.getElementById("updateTaskButton").addEventListener("click",(async()=>{const e=document.getElementById("updateTaskContent").value,t=document.getElementById("updateTaskId").value,o=await web3.eth.getAccounts();await n.methods.updateTask(t,e).send({from:o[0]}),window.location.reload()})),document.getElementById("completeTaskButton").addEventListener("click",(async()=>{const e=document.getElementById("completeTaskId").value,t=await web3.eth.getAccounts();await n.methods.toggleCompleted(e).send({from:t[0]}),window.location.reload()}))}catch(e){console.error(e)}finally{document.getElementById("loading").style.display="none"}}));